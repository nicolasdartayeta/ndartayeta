---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import FormattedDate from '../../components/FormattedDate.astro';
import { SITE_TITLE } from '../../consts';

const posts = (await getCollection('blog')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<Layout title={`Blog â€” ${SITE_TITLE}`} description="Writing on software, design, and things I find interesting.">

  <div class="mb-12">
    <h1 class="mb-2">Blog</h1>
    <p class="text-muted text-base m-0">Writing on software, design, and things I find interesting.</p>
  </div>
  {posts.length > 0 && (
  <div class="flex flex-col gap-5">
    {posts.map((post) => (
      <a href={`/blog/${post.id}/`}
         class="glass block p-7 no-underline text-ink transition-all hover:-translate-y-0.5 hover:shadow-[0_8px_32px_rgba(80,60,30,0.12)]">
        <p class="text-[0.8rem] text-muted mb-2">
          <FormattedDate date={post.data.pubDate} />
        </p>
        <h2 class="text-xl mb-2 text-accent">{post.data.title}</h2>
        <p class="text-[0.925rem] text-muted leading-relaxed mb-4">{post.data.description}</p>
        <span class="text-[0.85rem] font-semibold text-terra">Read &rarr;</span>
      </a>
    ))}
  </div>
  )}
  {posts.length === 0 && (
    <p class="text-base m-0">Blog posts coming soon...</p>
  )}
</Layout>
